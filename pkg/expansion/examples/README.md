# TKE expansion framework demo

## how to use

* copy directory `expansions` into a base directory, for example: `/tmp/`
* With this environment `export EXPANSION_BASE=/tmp/`, you can run tke-installer or `driver_test.TestNewExpansionDriver` (which will print the layout)

## expansion layout
* directory:
    * applications: application yaml files
    * charts: chart tars
    * files: `copy file` origin version, then they are going to be copied to `files_generated` directory
    * hooks: pre-install, post-cluster-ready, post-install files which TKE-installer will use
    * provider: provider files to override defaults
* file:
    * expansion.yaml: config of expansion which describe expansionName and expansionVersion
    * layout.yaml: config of layout which is generated by expansion layouts, and specifies skipSteps when running TKE install, and specifies skipConditions when creating cluster
    * tke.json: equals to layout.yaml, but presents as the TKE config. It will be merged into origin tke.json by TKE-installer. This file is auto generated when building expansion package
    * images.tar.gz: expansion images, which will be loaded by TKE-installer and push into registry
    * values.yaml: this file describes two parts of values:
        * global values: which will be used by each chart
        * chart value map: for each will be used by the chart it specifies

